<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CAUSAL LOGIC ENGINE v3.1</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #2563eb; --success: #10b981; --warning: #f59e0b; --bg: #f1f5f9; --card: #ffffff; }
        body { font-family: 'Prompt', sans-serif; background: var(--bg); margin: 0; padding: 20px; display: flex; justify-content: center; }
        .container { width: 100%; max-width: 500px; background: var(--card); border-radius: 28px; padding: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .header { text-align: center; margin-bottom: 25px; }
        .header h1 { font-size: 1.5rem; color: var(--primary); margin: 0; text-transform: uppercase; letter-spacing: 1px; }
        .status { font-size: 0.75rem; color: var(--success); font-weight: 600; margin-top: 5px; }
        .date-section { background: #f8fafc; padding: 15px; border-radius: 20px; margin-bottom: 20px; border: 1px solid #e2e8f0; text-align: center; }
        label { display: block; font-size: 0.75rem; color: #64748b; margin-bottom: 5px; font-weight: 600; text-transform: uppercase; }
        input { width: 100%; border: 1.5px solid #e2e8f0; border-radius: 12px; padding: 12px; font-size: 1rem; box-sizing: border-box; font-family: 'Prompt'; margin-bottom: 10px; }
        .btn-main { width: 100%; background: var(--primary); color: white; border: none; padding: 20px; border-radius: 18px; font-weight: 600; font-size: 1.1rem; cursor: pointer; margin-top: 15px; box-shadow: 0 8px 20px rgba(37, 99, 235, 0.3); text-transform: uppercase; }
        .result-panel { margin-top: 30px; display: none; }
        .section-title { font-size: 0.85rem; font-weight: 600; color: #475569; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; text-transform: uppercase; }
        .section-title::before { content: ''; width: 4px; height: 16px; background: var(--primary); border-radius: 10px; }
        .highlight-box { background: #f0f9ff; border: 1px dashed #bae6fd; border-radius: 15px; padding: 15px; margin-bottom: 20px; }
        .match-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; padding: 10px; background: white; border-radius: 12px; }
        .num-badge { background: var(--primary); color: white; padding: 5px 15px; border-radius: 20px; font-weight: 600; font-size: 1.1rem; }
        .num-badge.gold { background: var(--warning); }
        .conf-text { font-size: 0.8rem; font-weight: 600; color: var(--success); }
        .rating-card { background: white; border: 1.5px solid #f1f5f9; border-radius: 20px; padding: 15px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>CAUSAL ENGINE v3.1</h1>
        <div id="syncStatus" class="status">READY TO ANALYZE</div>
    </div>

    <div class="date-section">
        <label>‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
        <input type="date" id="drawDate" value="2026-01-17">
        <button style="width:100%; padding:10px; background:white; border:1px solid #2563eb; color:#2563eb; border-radius:10px; cursor:pointer; font-weight:600;" onclick="syncData()">DATABASE SYNC</button>
    </div>

    <div style="padding: 0 10px;">
        <label>SOCIAL ENERGY</label>
        <input type="text" id="socialInput" placeholder="895, 52...">
        <div style="display:flex; gap:10px;">
            <div style="flex:1"><label>TEMP (¬∞C)</label><input type="number" id="temp" value="22"></div>
            <div style="flex:1"><label>MOON PHASE</label><input type="text" id="moon" value="New Moon"></div>
        </div>
    </div>

    <button class="btn-main" onclick="runAnalysis()">üöÄ RUN COMPREHENSIVE ANALYSIS</button>

    <div id="resultArea" class="result-panel">
        <div class="section-title">3-Digit Reward Synthesis (AI Match)</div>
        <div id="res3Digit" class="highlight-box" style="background: #fffbeb; border-color: #fef3c7;">--</div>

        <div class="section-title">Intelligent Convergence (2-Digit)</div>
        <div id="res2Digit" class="highlight-box">--</div>

        <div class="section-title">Single Digit Rating (0-9)</div>
        <div id="resRating"></div>
    </div>
</div>

<script>
    const GIST_URL = "https://gist.githubusercontent.com/kittipan1984/f7a042eef3ccbcf7000c5ff84a0a53c3/raw/lottery-config.json";

    async function syncData() {
        const date = document.getElementById('drawDate').value;
        try {
            const res = await fetch(GIST_URL + "?t=" + new Date().getTime());
            const data = await res.json();
            const match = data.draws.find(d => d.date === date);
            if (match) {
                document.getElementById('socialInput').value = match.suggestedSocial;
                document.getElementById('temp').value = match.recommendedTemp;
                document.getElementById('moon').value = match.lunarPhase;
                document.getElementById('syncStatus').innerText = "DATABASE SYNCED SUCCESSFUL";
            }
        } catch (e) { alert("Sync Error"); }
    }

    function runAnalysis() {
        const social = document.getElementById('socialInput').value;
        const temp = parseInt(document.getElementById('temp').value);
        const moon = document.getElementById('moon').value;
        
        // 1. Single Digit Logic (0-9)
        let digits = [];
        for(let i=0; i<=9; i++) {
            let score = 8.0 + (i % 2 === temp % 2 ? 1.5 : 0);
            if(moon.length % 10 === i) score += 0.2;
            digits.push({ val: i, pts: score.toFixed(1) });
        }
        digits.sort((a,b) => b.pts - a.pts);
        
        const ratingArea = document.getElementById('resRating');
        ratingArea.innerHTML = "";
        digits.forEach(d => {
            ratingArea.innerHTML += `<div class="rating-card"><div style="font-size:1.8rem;font-weight:600;">${d.val}</div><div><span style="font-size:0.6rem;display:block;color:#94a3b8;">RATING</span><span style="font-size:1.2rem;font-weight:600;color:#10b981;">${d.pts} Pts</span></div></div>`;
        });

        // 2. 2-Digit Synthesis
        const topDigits = digits.slice(0, 4).map(d => d.val);
        const res2Area = document.getElementById('res2Digit');
        res2Area.innerHTML = "";
        let count2 = 0;
        for(let d1 of topDigits) {
            for(let d2 of topDigits) {
                if(d1 === d2 || count2 >= 5) continue;
                let conf = (d1 % 2 === temp % 2 && d2 % 2 === temp % 2) ? 95 : 85;
                res2Area.innerHTML += `<div class="match-row"><div class="num-badge">${d1}${d2}</div><div class="conf-text">Confidence ${conf}%</div></div>`;
                count2++;
            }
        }

        // 3. 3-Digit Synthesis (NEW LOGIC)
        // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏•‡∏Ç 3 ‡∏ï‡∏±‡∏ß‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏£‡∏ß‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏°‡∏µ Rating ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 3-4 ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡πÅ‡∏£‡∏Å
        const res3Area = document.getElementById('res3Digit');
        res3Area.innerHTML = "";
        let combinations = [];
        for(let i=0; i<topDigits.length; i++) {
            for(let j=0; j<topDigits.length; j++) {
                for(let k=0; k<topDigits.length; k++) {
                    let combo = `${topDigits[i]}${topDigits[j]}${topDigits[k]}`;
                    // ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏•‡∏Ç‡∏ï‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏ó‡∏≤‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ (‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô Logic ‡∏à‡∏∞‡πÅ‡∏Ç‡πá‡∏á‡∏°‡∏≤‡∏Å)
                    if(topDigits[i] === topDigits[j] && topDigits[j] === topDigits[k]) continue;
                    
                    let score3 = 80;
                    if(parseInt(combo) % 2 === temp % 2) score3 += 10;
                    if(social.includes(combo)) score3 += 9; // ‡∏ñ‡πâ‡∏≤‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö social ‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡πÄ‡∏ï‡πá‡∏°
                    
                    combinations.push({ val: combo, conf: score3 });
                }
            }
        }
        
        combinations.sort((a,b) => b.conf - a.conf).slice(0, 3).forEach(c => {
            res3Area.innerHTML += `<div class="match-row"><div class="num-badge gold">${c.val}</div><div class="conf-text" style="color:#d97706;">Confidence ${c.conf}%</div></div>`;
        });

        document.getElementById('resultArea').style.display = "block";
    }
</script>
</body>
</html>
